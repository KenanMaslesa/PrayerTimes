var positionFromStorage=localStorage.getItem("currentPosition");let currentPosition,latitude=localStorage.getItem("latitude"),longitude=localStorage.getItem("longitude"),method=localStorage.getItem("method"),currentTime,urlGetPrayerTimes,urlGetCity,urlCalendar,timeZone,fajr,sunrise,dhuhr,asr,maghrib,isha,currentDateTime,countDownTime,gregorianDate,hijriDate,country,county,flag,month,year,tempMonth=(new Date).getMonth()+1,tempYear=(new Date).getFullYear(),calendarFlag=!1;const monthNames=["","January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesBosnian=["","Januar","Februar","Mart","April","Maj","Juni","Juli","August","Septembar","Oktobar","Novembar","Decembar"];function successLocation(position){currentPosition=position,latitude=position.coords.latitude,longitude=position.coords.longitude,localStorage.setItem("latitude",latitude),localStorage.setItem("longitude",longitude),setupMap([longitude,latitude]),showPosition(method)}function errorLocation(){latitude=43.869308818408456,longitude=18.417377317154944,localStorage.setItem("latitude",latitude),localStorage.setItem("longitude",longitude),showPosition(method),window.location.reload()}function getRequest(funk,url){var request=new XMLHttpRequest;request.onload=function(){200==request.status?funk(JSON.parse(request.responseText)):(alert("Invalid coordinates. expecting latitude in (+/- 90) and longitude in (+/- 180) range values. You will be transferred to the Sarajevo"),latitude=43.869308818408456,longitude=18.417377317154944,localStorage.setItem("latitude",latitude),localStorage.setItem("longitude",longitude),showPosition(method),window.location.reload())},request.onerror=function(){latitude=43.869308818408456,longitude=18.417377317154944,localStorage.setItem("latitude",latitude),localStorage.setItem("longitude",longitude),showPosition(method)},request.open("GET",url,!0),request.send(null)}function showPosition(method){currentTime=new Date,null!=method?($("#locations option[value="+method+"]").prop("selected",!0),urlGetPrayerTimes=16==method?`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=3&tune=0,-4,-5,1,0,5,0,-1,-3`:`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6`):urlGetPrayerTimes=`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6`,urlGetCity=`https://api.bigdatacloud.net/data/reverse-geocode?latitude=${latitude}&longitude=${longitude}&key=2a1b056b085a47bfbe75c8452a37109c`,getRequest(GetCity,urlGetCity),getRequest(GetPrayerTimes,urlGetPrayerTimes),setTimeout(()=>{$(".loader").hide()},1200)}function GetCity(obj){country=""!=obj.countryName?obj.countryName:"",""!=obj.city?county=obj.city.replace("Metropolitan City of",""):""!=obj.locality&&(county=obj.locality.replace("Municipality",""),county=county.replace("municipality",""),county=county.replace("of",""),county=county.replace("City of",""),county=county.replace("Naselje",""),county=county.replace("Town of",""),county=county.replace("Town",""),county=county.replace("City",""),county=county.replace("Local community",""),county=county.replace("County",""),county=county.replace("Village",""),county=county.replace("Grad","")),document.querySelector(".country").textContent=country,document.querySelector(".city").textContent=county}function GetPrayerTimes(obj){sati=obj.data.timings.Fajr.substring(0,obj.data.timings.Fajr.indexOf(":")),minute=obj.data.timings.Fajr.substring(obj.data.timings.Fajr.indexOf(":")+1),hijriDate=obj.data.date.hijri.day+" "+obj.data.date.hijri.month.en+", "+obj.data.date.hijri.year,gregorianDate=obj.data.date.gregorian.day+" "+obj.data.date.gregorian.month.en+", "+obj.data.date.gregorian.year,month=obj.data.date.gregorian.month.en,timeZone=obj.data.meta.timezone,year=(new Date).getFullYear();var zone,bosnianInstruction="Kliknite na bilo koje mjesto na karti za koje želite vidjeti vrijeme namaza",englishInstruction="Click anywhere on the map where you want to see prayer times";flag=["Europe/Sarajevo","Europe/Zagreb","Europe/Belgrade","Europe/Podgorica","Europe/Skopje"].includes(timeZone),fajr=obj.data.timings.Fajr,sunrise=obj.data.timings.Sunrise,dhuhr=obj.data.timings.Dhuhr,asr=obj.data.timings.Asr,maghrib=obj.data.timings.Maghrib,isha=obj.data.timings.Isha,$(".hijri-date").text(hijriDate),$(".gregorian-date").text(gregorianDate+" / "),$(".fajr-time").text(flag?fajr:formatAMPM(fajr)),$(".sunrise-time").text(flag?sunrise:formatAMPM(sunrise)),$(".dhuhr-time").text(flag?dhuhr:formatAMPM(dhuhr)),$(".asr-time").text(flag?asr:formatAMPM(asr)),$(".maghrib-time").text(flag?maghrib:formatAMPM(maghrib)),$(".isha-time").text(flag?isha:formatAMPM(isha)),$(".fajr-caption").text(flag?"Zora":"Fajr"),$(".sunrise-caption").text(flag?"Izlazak sunca":"Sunrise"),$(".dhuhr-caption").text(flag?"Podne":"Dhuhr"),$(".asr-caption").text(flag?"Ikindija":"Asr"),$(".maghrib-caption").text(flag?"Akšam":"Maghrib"),$(".isha-caption").text(flag?"Jacija":"Isha"),$(".instructions").text(flag?bosnianInstruction:englishInstruction),$(".upcoming-prayer").text(flag?"nadolazeći namaz":"upcoming prayer"),$(".mapboxgl-ctrl-geocoder--input").attr("placeholder",flag?"Pretraži mjesta":"Search for places"),$(".autolocation").text(flag?"Lociraj me":"Locate me"),removeActiveClass(),$(".isha").addClass("active"),upcomingPrayer(),$(".fajr").find(".upcoming-prayer").css({visibility:"visible"}),setTimeout(()=>{$(".isha").hasClass("active")&&($("#dark_theme").trigger("click"),$(".local-time-wrapper").removeClass("day"))},1e3),hours=fajr.substring(0,fajr.indexOf(":")),minutes=fajr.substring(fajr.indexOf(":")+1),currentDateTime=new Date((new Date).toLocaleString("en-US",{timeZone:timeZone})),countDownTime=new Date(currentDateTime),countDownTime.setHours(hours),countDownTime.setMinutes(minutes),countDownTime.setSeconds(0),urlCalendar=16==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=3&tune=0,-4,-5,1,0,5,0,-1,-3&month=${currentDateTime.getMonth()+1}&year=${currentDateTime.getFullYear()}`:17==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6&month=${currentDateTime.getMonth()+1}&year=${currentDateTime.getFullYear()}`:`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=${method}&month=${currentDateTime.getMonth()+1}&year=${currentDateTime.getFullYear()}`,getRequest(getCalendar,urlCalendar)}function formatTime(h){return h<10?"0"+h:h}function setHours(h){hours=h.substring(0,h.indexOf(":")),countDownTime.setHours(hours)}function setMinutes(m){minutes=m.substring(m.indexOf(":")+1),countDownTime.setMinutes(minutes)}function removeActiveClass(){document.querySelector(".fajr").classList.remove("active"),document.querySelector(".sunrise").classList.remove("active"),document.querySelector(".dhuhr").classList.remove("active"),document.querySelector(".asr").classList.remove("active"),document.querySelector(".maghrib").classList.remove("active"),document.querySelector(".isha").classList.remove("active")}function setTimes(){currentDateTime>=countDownTime.getTime()&&(setHours(sunrise),setMinutes(sunrise),removeActiveClass(),$(".fajr").addClass("active")),currentDateTime>=countDownTime.getTime()&&(setHours(dhuhr),setMinutes(dhuhr),removeActiveClass(),$(".sunrise").addClass("active")),currentDateTime>=countDownTime.getTime()&&(setHours(asr),setMinutes(asr),removeActiveClass(),$(".dhuhr").addClass("active")),currentDateTime>=countDownTime.getTime()&&(setHours(maghrib),setMinutes(maghrib),removeActiveClass(),$(".asr").addClass("active")),currentDateTime>=countDownTime.getTime()&&(setHours(isha),setMinutes(isha),removeActiveClass(),$(".maghrib").addClass("active")),currentDateTime>=countDownTime.getTime()&&(removeActiveClass(),$(".isha").addClass("active"),countDownTime.setDate(countDownTime.getDate()+1),setHours(fajr),setMinutes(fajr)),upcomingPrayer(),$(".maghrib").hasClass("active")||$(".isha").hasClass("active")||$(".fajr").hasClass("active")?($("#dark_theme").trigger("click"),$(".local-time-wrapper").removeClass("day")):$("#light_theme").trigger("click")}function upcomingPrayer(){$activeTime=$(".active"),removeUpcomingPrayer(),$activeTime.hasClass("fajr")?($(".sunrise").find(".upcoming-prayer").text(flag?"slijedi":"upcoming"),$(".sunrise").find(".upcoming-prayer").css({visibility:"visible"}),$(".local-time-wrapper").removeClass("day")):$activeTime.hasClass("sunrise")?($(".dhuhr").find(".upcoming-prayer").css({visibility:"visible"}),$(".local-time-wrapper").addClass("day")):$activeTime.hasClass("dhuhr")?($(".asr").find(".upcoming-prayer").css({visibility:"visible"}),$(".local-time-wrapper").addClass("day")):$activeTime.hasClass("asr")?($(".maghrib").find(".upcoming-prayer").css({visibility:"visible"}),$(".local-time-wrapper").addClass("day")):$activeTime.hasClass("maghrib")?($(".isha").find(".upcoming-prayer").css({visibility:"visible"}),$(".local-time-wrapper").removeClass("day")):$activeTime.hasClass("isha")&&$(".fajr").find(".upcoming-prayer").css({visibility:"visible"})}function removeUpcomingPrayer(){$(".fajr").find(".upcoming-prayer").css({visibility:"hidden"}),$(".sunrise").find(".upcoming-prayer").css({visibility:"hidden"}),$(".dhuhr").find(".upcoming-prayer").css({visibility:"hidden"}),$(".asr").find(".upcoming-prayer").css({visibility:"hidden"}),$(".maghrib").find(".upcoming-prayer").css({visibility:"hidden"}),$(".isha").find(".upcoming-prayer").css({visibility:"hidden"})}null==latitude||null==longitude?navigator.geolocation.getCurrentPosition(successLocation,errorLocation,{enableHighAccuracy:!0}):(setupMap([longitude,latitude]),showPosition(method)),document.querySelector(".autolocation").addEventListener("click",(function(){navigator.geolocation.getCurrentPosition(successLocation,errorLocation,{enableHighAccuracy:!0})})),$("#plus").on("click",(function(){calendarFlag=!0,tempMonth>=12?(tempYear++,tempMonth=1):tempMonth++,urlCalendar=16==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=3&tune=0,-4,-5,1,0,5,0,-1,-3&month=${tempMonth}&year=${tempYear}`:17==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6&month=${tempMonth}&year=${tempYear}`:`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=${method}&month=${tempMonth}&year=${tempYear}`,getRequest(getCalendar,urlCalendar)})),$("#minus").on("click",(function(){calendarFlag=!0,tempMonth<=1?(tempYear--,tempMonth=12):tempMonth--,urlCalendar=16==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=3&tune=0,-4,-5,1,0,5,0,-1,-3&month=${tempMonth}&year=${tempYear}`:17==method?`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6&month=${tempMonth}&year=${tempYear}`:`https://api.aladhan.com/v1/calendar?latitude=${latitude}&longitude=${longitude}&method=${method}&month=${tempMonth}&year=${tempYear}`,getRequest(getCalendar,urlCalendar)}));var x=setInterval((function(){if(currentDateTimeMiliSeconds>=countDownTimeMiliSeconds&&setTimes(),currentDateTime=new Date((new Date).toLocaleString("en-US",{timeZone:timeZone})),setTime(currentDateTime),null!=countDownTime){var currentDateTimeMiliSeconds=currentDateTime.getTime(),countDownTimeMiliSeconds=countDownTime.getTime();currentDateTimeMiliSeconds>=countDownTimeMiliSeconds&&setTimes();var distance=countDownTimeMiliSeconds-currentDateTimeMiliSeconds,hours=Math.floor(distance%864e5/36e5),minutes=Math.floor(distance%36e5/6e4),seconds=Math.floor(distance%6e4/1e3);0==hours&&minutes<=9?$(".countdown").addClass("danger"):$(".countdown").removeClass("danger"),distance>0&&$(".countdown").html(formatTime(hours)+":"+formatTime(minutes)+":"+formatTime(seconds))}}),1e3);function formatAMPM(time){var hours,minutes,ampm=(hours=parseInt(time.substring(0,time.indexOf(":"))))>=12?"PM":"AM",strTime;return(hours=(hours%=12)||12)+":"+(minutes=(minutes=parseInt(time.substring(time.indexOf(":")+1)))<10?"0"+minutes:minutes)+" "+ampm}function dayofMonth(d){return(d.getDate()<10?"0":"")+d.getDate()}function getCalendar(obj){document.querySelector("#table tbody").innerHTML="";for(var i=0;i<obj.data.length;i++)document.querySelector("#table tbody").innerHTML+=Rows(obj.data[i]);$(".date-caption").text(flag?"Datum":"Date"),$(`td[data-day="${dayofMonth(new Date)+((new Date).getMonth()+1)}"]`).parent().addClass("active"),$('#table .calendar-date:contains("fri")').parent().addClass("friday"),$('#table .calendar-date:contains("pet")').parent().addClass("friday"),calendarFlag?$(".calendar-caption").text(flag?monthNamesBosnian[tempMonth]+" "+tempYear:monthNames[tempMonth]+" "+tempYear):$(".calendar-caption").text(flag?getBosnianMonths(month)+" "+tempYear:month+" "+tempYear),$(".calendar").addClass("show")}function Rows(obj){return`<tr>\n      <td class="calendar-date" data-day="${obj.date.gregorian.day+tempMonth}">${obj.date.gregorian.day}. ${flag?getBosnianDays(obj.date.gregorian.weekday.en):getEnglishDays(obj.date.gregorian.weekday.en)}</td>\n      <td>${obj.timings.Fajr.substring(0,obj.timings.Fajr.indexOf(" "))}</td>\n      <td>${obj.timings.Sunrise.substring(0,obj.timings.Sunrise.indexOf(" "))}</td>\n      <td>${obj.timings.Dhuhr.substring(0,obj.timings.Dhuhr.indexOf(" "))}</td>\n      <td>${obj.timings.Asr.substring(0,obj.timings.Asr.indexOf(" "))}</td>\n      <td>${obj.timings.Maghrib.substring(0,obj.timings.Maghrib.indexOf(" "))}</td>\n      <td>${obj.timings.Isha.substring(0,obj.timings.Isha.indexOf(" "))}</td>\n  </tr>`}function getBosnianDays(day){return"Monday"==day?"pon":"Tuesday"==day?"uto":"Wednesday"==day?"sri":"Thursday"==day?"čet":"Friday"==day?"pet":"Saturday"==day?"sub":"Sunday"==day?"ned":void 0}function getEnglishDays(day){return"Monday"==day?"mon":"Tuesday"==day?"tue":"Wednesday"==day?"wed":"Thursday"==day?"thu":"Friday"==day?"fri":"Saturday"==day?"sat":"Sunday"==day?"sun":void 0}function getBosnianMonths(month){return"January"==month?"Januar":"February"==month?"Februar":"March"==month?"Mart":"April"==month?"April":"May"==month?"Maj":"June"==month?"Juni":"July"==month?"Juli":"August"==month?"August":"September"==month?"Septembar":"October"==month?"Oktobar":"November"==month?"Novembar":"December"==month?"Decembar":void 0}$("#locations").change((function(){method=$(this).val(),localStorage.setItem("method",method),currentTime=new Date,urlGetPrayerTimes=16==method?`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=3&tune=0,-4,-5,1,0,5,0,-1,-3`:17==method?`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=99&methodSettings=14.6,null,14.6`:`https://api.aladhan.com/v1/timings/${currentTime.getTime()/1e3}?latitude=${latitude}&longitude=${longitude}&method=${method}`,getRequest(GetPrayerTimes,urlGetPrayerTimes)})),$("#toggle-icon").click((function(){var isMobile=window.matchMedia("(max-width: 700px)");$("#map").slideToggle(),$(".prayer-times-wrapper").css({"z-index":"9999"}),$(".autolocation").toggle("slow"),$(".local-time-wrapper").toggleClass("toggle"),$(".calculation-methods").toggleClass("toggle"),$(".instructions").toggle(1e3),isMobile.matches&&($(".local-time-wrapper.mobile").toggle(300),$(this).toggleClass("toggle"),$(".dark-light-mode").toggleClass("toggle")),window.matchMedia("(max-width: 900px)").matches&&setTimeout(()=>{$(".instructions").remove()},8e3)})),$(".print").on("click",(function(){window.print()})),window.onload=function(){setTimeout(()=>{$("#toggle-icon").trigger("click")},5e3)};const hourEl=document.querySelector(".hour"),minuteEl=document.querySelector(".minute"),secondEl=document.querySelector(".second"),timeEl=document.querySelector(".time"),dateEl=document.querySelector(".date"),days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],bosnianDays=["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function setTime(time=null){if(null!=time){const month=time.getMonth(),day=time.getDay(),date=time.getDate(),hours=time.getHours(),hoursForClock=hours>=13?hours%12:hours,minutes=time.getMinutes(),seconds=time.getSeconds(),ampm=hours>=12?"PM":"AM";hourEl.style.transform=`translate(-50%, -100%) rotate(${scale(hoursForClock,0,11,0,360)}deg)`,minuteEl.style.transform=`translate(-50%, -100%) rotate(${scale(minutes,0,59,0,360)}deg)`,secondEl.style.transform=`translate(-50%, -100%) rotate(${scale(seconds,0,59,0,360)}deg)`,flag?(timeEl.innerHTML=`${hours}:${minutes<10?`0${minutes}`:minutes}`,dateEl.innerHTML=`${bosnianDays[day]}, ${months[month]} <span class="circle">${date}</span>`):(timeEl.innerHTML=`${hoursForClock}:${minutes<10?`0${minutes}`:minutes} ${ampm}`,dateEl.innerHTML=`${days[day]}, ${months[month]} <span class="circle">${date}</span>`)}}const scale=(num,in_min,in_max,out_min,out_max)=>(num-in_min)*(out_max-out_min)/(in_max-in_min)+out_min;setTime(),setInterval(setTime,1e3);